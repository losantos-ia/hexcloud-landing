<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HEXCLOUD - El Futuro de la Gestión de Talleres</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .gradient-text {
            background: linear-gradient(90deg, #003f5c, #58508d, #bc5090);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
            100% { transform: translateY(0px); }
        }
        .floating-icon {
            animation: float 5s ease-in-out infinite;
        }
        .form-container {
            transition: all 0.5s ease-in-out;
        }
        .spinner {
            border-top-color: #ffa600;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body class="bg-gray-900 text-white">

    <div class="container mx-auto flex flex-col items-center justify-center min-h-screen p-6 text-center">

        <!-- Logo and Main Message -->
        <div class="w-28 h-28 mx-auto mb-8 floating-icon">
            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <linearGradient id="iconGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#58508d;" />
                        <stop offset="100%" style="stop-color:#bc5090;" />
                    </linearGradient>
                </defs>
                <path d="M86.6 25 L50 5 L13.4 25 L13.4 75 L50 95 L86.6 75 Z" fill="url(#iconGradient)"/>
                <g transform="translate(5, 5)">
                    <path d="M45 30 L60 45 L45 60" fill="none" stroke="#ffa600" stroke-width="5" stroke-linecap="round" stroke-linejoin="round"/>
                    <circle cx="35" cy="50" r="5" fill="#ffa600"/>
                </g>
            </svg>
        </div>

        <h1 class="text-4xl md:text-6xl font-black text-white leading-tight">¿Harto de software de taller de los 90?</h1>
        <p class="text-2xl md:text-3xl mt-4 gradient-text font-bold">El futuro de la gestión está llegando.</p>
        <p class="text-lg md:text-xl mt-8 text-gray-300 max-w-3xl mx-auto">
            Presentamos <span class="font-bold text-white">HEXCLOUD</span>, el primer ERP para talleres en España que utiliza Inteligencia Artificial para eliminar el trabajo administrativo. Desde la recepción de citas hasta la creación de presupuestos rentables, nuestro Copiloto IA te devuelve el tiempo para que te dediques a lo que de verdad importa.
        </p>

        <!-- Form Container -->
        <div id="form-container" class="form-container mt-12 w-full max-w-lg">
            <p class="font-semibold mb-4">Sé el primero en probarlo. Apúntate a la lista de acceso anticipado.</p>
            <form id="interest-form" class="flex flex-col sm:flex-row gap-4">
                <input type="text" id="name" name="name" placeholder="Tu nombre" required class="w-full px-4 py-3 rounded-md bg-gray-800 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-[#ffa600]">
                <input type="email" id="email" name="email" placeholder="Tu email" required class="w-full px-4 py-3 rounded-md bg-gray-800 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-[#ffa600]">
                <button type="submit" class="bg-[#ffa600] hover:bg-amber-500 text-white font-bold py-3 px-6 rounded-md shadow-lg transition duration-300 whitespace-nowrap">
                    Quiero mi Acceso
                </button>
            </form>
        </div>
        
        <!-- Thank You Message Container -->
        <div id="thank-you-container" class="form-container mt-12 w-full max-w-2xl hidden bg-gray-800 p-8 rounded-lg border border-gray-700">
             <h2 class="text-2xl font-bold text-white">¡Gracias, <span id="user-name"></span>! Estás en la lista.</h2>
             <p class="text-gray-300 mt-4">Eres parte de un grupo exclusivo que está a punto de cambiar la forma en que se gestionan los talleres. Te contactaremos personalmente en cuanto abramos las primeras plazas para la demo.</p>
             <div id="feedback-form" class="mt-6 text-left">
                <label for="feedback" class="font-semibold text-white">Para ayudarnos a construir la mejor herramienta para ti, ¿te importaría responder a esta única pregunta?</label>
                <textarea id="feedback" name="feedback" rows="3" placeholder="Ej: Odio hacer inventario, perder tiempo con los presupuestos, no saber qué coches son más rentables..." class="w-full mt-2 px-4 py-3 rounded-md bg-gray-700 border border-gray-600 text-white focus:outline-none focus:ring-2 focus:ring-[#ffa600]"></textarea>
                <button id="send-feedback" class="mt-4 bg-[#ffa600] hover:bg-amber-500 text-white font-bold py-2 px-5 rounded-md shadow-lg transition duration-300 flex items-center justify-center">
                    <span id="feedback-btn-text">✨ Enviar y Analizar con IA</span>
                    <div id="feedback-spinner" class="spinner h-5 w-5 ml-3 border-4 hidden"></div>
                </button>
             </div>
             <div id="gemini-response-container" class="hidden mt-6 p-4 bg-gray-700 rounded-lg text-left">
                <!-- Gemini's empathetic response will be shown here -->
             </div>
        </div>

    </div>

    <!-- Founder Section -->
    <div class="bg-gray-800 py-16">
        <div class="container mx-auto px-6 max-w-4xl flex flex-col md:flex-row items-center gap-8">
            <img src="https://placehold.co/150x150/2d3748/e2e8f0?text=E.A." alt="Foto de Edward Ávila" class="w-36 h-36 rounded-full border-4 border-[#ffa600]">
            <div class="text-center md:text-left">
                <p class="text-lg text-gray-300 italic">"Soy Edward Ávila, dueño de Taller Los Santos. Estoy construyendo HEXCLOUD para resolver los problemas que he sufrido durante años. Esta es una herramienta hecha desde el foso, no desde una sala de juntas."</p>
                <p class="font-bold text-white mt-4">- Edward Ávila, Fundador de HEXCLOUD</p>
            </div>
        </div>
    </div>


    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, doc, updateDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            // Your Firebase config will be injected here in a real environment
            // For now, this is a placeholder
            apiKey: "AIza...",
            authDomain: "your-project-id.firebaseapp.com",
            projectId: "your-project-id",
            storageBucket: "your-project-id.appspot.com",
            messagingSenderId: "...",
            appId: "..."
        };

        let app, auth, db;
        let currentLeadId = null;

        try {
            app = initializeApp(JSON.parse(__firebase_config || JSON.stringify(firebaseConfig)));
            auth = getAuth(app);
            db = getFirestore(app);
            await signInAnonymously(auth);
        } catch (error) {
            console.error("Firebase initialization failed. Using in-memory mode.", error);
        }

        const interestForm = document.getElementById('interest-form');
        const formContainer = document.getElementById('form-container');
        const thankYouContainer = document.getElementById('thank-you-container');
        const userNameSpan = document.getElementById('user-name');
        const sendFeedbackBtn = document.getElementById('send-feedback');
        const feedbackForm = document.getElementById('feedback-form');
        const geminiResponseContainer = document.getElementById('gemini-response-container');
        const feedbackSpinner = document.getElementById('feedback-spinner');
        const feedbackBtnText = document.getElementById('feedback-btn-text');

        interestForm.addEventListener('submit', async function(event) {
            event.preventDefault();
            
            const nameInput = document.getElementById('name');
            const emailInput = document.getElementById('email');
            const userName = nameInput.value.split(' ')[0];

            if (db) {
                try {
                    const docRef = await addDoc(collection(db, "waitlist"), {
                        name: nameInput.value,
                        email: emailInput.value,
                        timestamp: serverTimestamp()
                    });
                    currentLeadId = docRef.id;
                    console.log("Document written with ID: ", currentLeadId);
                } catch (e) {
                    console.error("Error adding document: ", e);
                }
            } else {
                 console.log('DB not available. Form data:', { name: nameInput.value, email: emailInput.value });
            }

            userNameSpan.textContent = userName;
            formContainer.style.opacity = '0';
            formContainer.style.transform = 'scale(0.95)';
            
            setTimeout(() => {
                formContainer.classList.add('hidden');
                thankYouContainer.classList.remove('hidden');
                thankYouContainer.style.opacity = '0';
                thankYouContainer.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    thankYouContainer.style.opacity = '1';
                    thankYouContainer.style.transform = 'scale(1)';
                }, 50);
            }, 500);
        });

        sendFeedbackBtn.addEventListener('click', async function() {
            const feedbackText = document.getElementById('feedback').value;
            if (!feedbackText.trim()) return;

            feedbackSpinner.classList.remove('hidden');
            feedbackBtnText.textContent = 'Analizando...';
            sendFeedbackBtn.disabled = true;

            try {
                const response = await fetch('/api/analyze-feedback', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ feedback: feedbackText })
                });

                if (!response.ok) throw new Error('Network response was not ok');

                const geminiData = await response.json();

                if (db && currentLeadId) {
                    const leadDocRef = doc(db, "waitlist", currentLeadId);
                    await updateDoc(leadDocRef, {
                        feedback: feedbackText,
                        feedback_category: geminiData.category || 'Otro',
                        gemini_response: geminiData.empathy_response || ''
                    });
                } else {
                    console.log('DB not available. Feedback data:', { feedback: feedbackText, category: geminiData.category });
                }

                geminiResponseContainer.innerHTML = `<p class="font-semibold">🤖 Copiloto IA dice:</p><p class="mt-2 text-gray-300 italic">"${geminiData.empathy_response}"</p>`;
                feedbackForm.classList.add('hidden');
                geminiResponseContainer.classList.remove('hidden');

            } catch (error) {
                console.error("Error with feedback analysis or Firestore:", error);
                feedbackForm.classList.add('hidden');
                geminiResponseContainer.innerHTML = `<p class="text-amber-400">¡Gracias por tu feedback! Lo hemos guardado correctamente.</p>`;
                geminiResponseContainer.classList.remove('hidden');
                 if (db && currentLeadId) {
                    const leadDocRef = doc(db, "waitlist", currentLeadId);
                    await updateDoc(leadDocRef, { feedback: feedbackText });
                }
                // Reset button state on error
                feedbackSpinner.classList.add('hidden');
                feedbackBtnText.textContent = '✨ Enviar y Analizar con IA';
                sendFeedbackBtn.disabled = false;
            }
        });
    </script>
</body>
</html>
